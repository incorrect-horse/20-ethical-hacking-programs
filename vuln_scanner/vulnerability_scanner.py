import scanner

# URL = "http://10.0.2.6/mutillidae/"
URL = "http://10.0.2.6/dvwa/"
links_to_ignore = ["http://10.0.2.6/dvwa/logout.php"]

data_dict = {"username": "admin", "password": "password", "Login": "submit"}

vuln_scanner = scanner.Scanner(URL, links_to_ignore)
vuln_scanner.session.post("http://10.0.2.6/dvwa/login.php", data=data_dict)

try:
    # # vuln_scanner.crawl()
    # forms = vuln_scanner.extract_forms("http://10.0.2.6/dvwa/vulnerabilities/xss_r")
    # # print(forms)
    # response = vuln_scanner.test_xss_in_link("http://10.0.2.6/dvwa/vulnerabilities/xss_r/?name=test")
    # # print(response.content.decode())
    # print(response)
    vuln_scanner.run_scanner()
except KeyboardInterrupt:
    print("\n[-] Detected CTRL+C ... terminating app, please wait.")

print("Goodbye!")
